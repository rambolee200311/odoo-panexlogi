<odoo>
    <template id="report_ar_invoice_template_view">
        <t t-call="web.html_container">
            <t t-call="panexLogi.report_layout_no_header_footer">
                <style>
                    /* Consolidated CSS classes */
                    .bordered-cell {
                        border: 1px solid black !important;
                        padding: 8px !important;
                        vertical-align: middle !important;
                    }
                    .non-bordered-cell {
                        border: none !important;
                        padding: 8px !important;
                        vertical-align: middle !important;
                    }

                    .label-cell {
                        width: 10%;
                        background-color: #f8f9fa;  /* Subtle background for labels */
                    }

                    .info-cell {
                        width: 40%;
                        font-weight: bold;  /* Emphasize important data */
                    }
                    /* 荷兰格式优化版 */
                    .total-amount::before {
                        content: "€\00a0";       /* 符号与金额间隔符 */
                        font-family: Arial, sans-serif;
                        vertical-align: -0.1em;  /* 符号垂直对齐修正 */
                        margin-right: 2px;       /* 增加右侧间距 */
                    }
                    .total-amount {
                        font-size: 1.2em;
                        color: #2c3e50;
                        font-family: "Courier New", monospace;  /* 更清晰的等宽字体 */
                        letter-spacing: 0.7px;   /* 加强长数字可读性 */
                        direction: ltr;          /* 强制左到右文本方向 */
                        unicode-bidi: embed;     /* 防止符号位置异常 */
                    }
                    /* 金额数字对齐优化 */
                    .total-amount > span {
                        display: inline-block;
                        min-width: 8em;         /* 保证最小列宽 */
                        text-align: right;      /* 数字右对齐 */
                    }
                    .table-bordered {
                        border: 1px solid black !important;
                        border-collapse: collapse !important;
                    }
                    .table-bordered td,
                    .table-bordered th {
                        border: 1px solid black !important;
                        padding: 8px !important;
                    }
                    .table-non-bordered {
                        border: none !important;
                        border-collapse: collapse !important;
                    }
                    .table-non-bordered tr,
                    .table-non-bordered td,
                    .table-non-bordered th {
                        border: none !important;
                        padding: 2px !important;
                    }

                    .align-center { text-align: center; vertical-align: middle; }
                    .align-left { text-align: left; vertical-align: middle; }
                    .align-right { text-align: right; vertical-align: middle; }
                </style>

                <t t-name="panexLogi.report_ar_invoice_template_view">
                    <t t-set="format_date" t-value="request.env['ir.qweb.field.date'].value_to_html"/>
                    <t t-foreach="docs" t-as="o">
                        <div class="page">
                            <!-- Company Info Section -->
                            <table style="width: 100%; margin-bottom: 20px;">
                                <tr>
                                    <td class="non-bordered-cell info-cell">
                                        <div style="margin-bottom: 12px; font-size: 1.4em;">
                                            <span t-field="o.ar_company.name"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [Address]<span t-esc="o.ar_company.street or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [City.Country]<span t-esc="o.ar_company.city or 'N/A'"/>,<span t-esc="o.ar_company.country_id.name or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [Phone]<span t-esc="o.ar_company.phone or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [Kvk]<span t-esc="o.ar_company.x_kvknr or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [VAT]<span t-esc="o.ar_company.vat or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [IBAN]<span t-esc="o.ar_company_account.acc_number or 'N/A'"/>
                                        </div>
                                        <div style="line-height: 1.5;">
                                            [BIC]<span t-esc="o.ar_company_account.bank_bic or 'N/A'"/>
                                        </div>
                                    </td>
                                    <td style="width: 50%; text-align: center; vertical-align: middle;">
                                        <h2 style="margin: 0 0 15px 0; color: #34495e;">INVOICE</h2>
                                        <table style="width: 100%;">
                                            <tr>
                                                <td class="bordered-cell label-cell">[Date]</td>
                                                <td class="bordered-cell info-cell">
                                                    <span t-field="o.invoice_date" t-options='{"format": "dd/MM/yyyy"}'/>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="bordered-cell label-cell">[Invoice #]</td>
                                                <td class="bordered-cell info-cell">
                                                    <span t-field="o.invoice_number"/>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            <!-- Customer Info Section -->
                            <table style="width: 100%; margin-top: 20px;">
                                <thead>
                                    <tr style="background-color: #ecf0f1;">
                                        <th class="align-center" style="width: 50%">BILL TO</th>
                                        <th class="align-center" style="width: 50%">SHIP TO</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="non-bordered-cell info-cell">
                                            <div style="line-height: 1.5;">
                                                <span t-field="o.customer.name"/>
                                            </div>
                                            <div style="line-height: 1.5;">
                                                [Address]<span t-esc="o.customer.street or 'N/A'"/>
                                            </div>
                                            <div style="line-height: 1.5;">
                                                [City.Country]<span t-esc="o.customer.city or 'N/A'"/>,<span t-esc="o.customer.country_id.name or 'N/A'"/>
                                            </div>
                                            <div style="line-height: 1.5;">
                                                [Phone]<span t-esc="o.customer.phone or 'N/A'"/>
                                            </div>
                                            <div style="line-height: 1.5;">
                                                [Kvk]<span t-esc="o.customer.x_kvknr or 'N/A'"/>
                                            </div>
                                            <div style="line-height: 1.5;">
                                                [VAT]<span t-esc="o.customer.vat or 'N/A'"/>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>

                            <!-- Line Items Table -->
                            <table class="table table-bordered" style="width: 100%; margin-top: 20px;">
                                <thead>
                                    <tr style="background-color: #ecf0f1;">
                                        <th class="align-center">NO</th>
                                        <th class="align-center">SERVICE</th>
                                        <th class="align-center">DESCRIPTION</th>
                                        <th class="align-center">TOTAL</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="o.invoice_line_ids">
                                        <t t-foreach="o.invoice_line_ids" t-as="line" t-enumerate="line_index">
                                            <tr>
                                                <td class="align-center"><span t-esc="line_index + 1"/></td>
                                                <td class="align-left"><span t-esc="line.fitem_name"/></td>
                                                <td class="align-left"><span t-esc="line.remark"/></td>
                                                <td class="align-right">
                                                    <div class="total-amount" lang="nl-NL">
                                                        <span t-esc="line.invoice_amount"/>
                                                    </div>
                                                </td>
                                            </tr>
                                        </t>
                                    </t>
                                    <t t-if="not o.invoice_line_ids">
                                        <tr>
                                            <td colspan="4" class="align-center">No line items found</td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                            <!-- Total Amount Section -->
                            <table style="width: 100%; border-collapse: collapse; font-family: Arial, sans-serif;">
                                <!-- First Row: Payment Method + Price Components -->
                                <tr>
                                    <td style="border: 1px solid black; padding: 8px; width: 50%; vertical-align: top;">
                                        <strong>Pay by:</strong> bank transfer
                                    </td>
                                    <td style="border: 1px solid black; padding: 8px; width: 50%;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td>SUBTOTAL</td>
                                                <td style="text-align: right;">
                                                    <div class="total-amount" lang="nl-NL">
                                                    <span t-esc="o.invoice_amount"/>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>SHIPPING</td>
                                                <td style="text-align: right;">0</td>
                                            </tr>
                                            <tr>
                                                <td>VAT</td>
                                                <td style="text-align: right;">0</td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>

                                <!-- Second Row: Remarks + Total Components -->
                                <tr>
                                    <td style="border: 1px solid black; padding: 8px; vertical-align: top;">
                                        <strong>Remark:</strong><span t-esc="o.remark or 'N/A'"/>
                                    </td>
                                    <td style="border: 1px solid black; padding: 8px;">
                                        <table style="width: 100%;">
                                            <tr>
                                                <td>VAT Charged</td>
                                                <td style="text-align: right;">
                                                    <div class="total-amount" lang="nl-NL">
                                                        <span t-esc="o.invoice_vat"/>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr style="background-color: #f0f0f0;">
                                                <td><strong>TOTAL</strong></td>
                                                <td style="text-align: right;">
                                                    <div class="total-amount" lang="nl-NL">
                                                        <span t-esc="o.invoice_amount_with_vat"/>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Currency</td>
                                                <td style="text-align: right;"><span t-esc="o.currency_id.name"/></td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>

                        </div>
                    </t>
                </t>
            </t>
        </t>
    </template>
</odoo>